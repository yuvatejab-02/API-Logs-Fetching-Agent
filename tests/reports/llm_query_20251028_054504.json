{
  "test_name": "llm_query_generation",
  "timestamp": "2025-10-28T05:45:04.339061+00:00",
  "status": "passed",
  "input": {
    "incident_payload": {
      "compslug": "companyname",
      "Session_id": "7b3f2f30-0c4b-4c42-9f8f-7e3d2b8e2a61",
      "incident_id": "INC_test_001",
      "title": "Spike in 5xx errors for payments service",
      "service": {
        "id": "al89asf9asdhjfaslkdjfl",
        "name": "payments-service"
      }
    },
    "lookback_hours": 1
  },
  "llm_output": {
    "filter_expression": "service.name = 'payments-service' AND http.status_code >= 500 AND http.status_code < 600 AND severity_text = 'ERROR'",
    "reasoning": "Since this is a 5xx error spike in payments service, we filter for the exact service name, all 5xx status codes (500-599), and error severity to capture critical failures while excluding non-error logs",
    "key_attributes": [
      "service.name",
      "http.status_code",
      "severity_text"
    ]
  },
  "signoz_query": {
    "start": 1761626704335,
    "end": 1761630304335,
    "requestType": "raw",
    "variables": {},
    "compositeQuery": {
      "queries": [
        {
          "type": "builder_query",
          "spec": {
            "name": "A",
            "signal": "logs",
            "filter": {
              "expression": "service.name = 'payments-service' AND http.status_code >= 500 AND http.status_code < 600 AND severity_text = 'ERROR'"
            },
            "order": [
              {
                "key": {
                  "name": "timestamp"
                },
                "direction": "desc"
              },
              {
                "key": {
                  "name": "id"
                },
                "direction": "desc"
              }
            ],
            "offset": 0,
            "limit": 1000
          }
        }
      ]
    }
  },
  "query_details": {
    "time_range": {
      "start_ms": 1761626704335,
      "end_ms": 1761630304335,
      "start_human": "2025-10-28T04:45:04.335000+00:00",
      "end_human": "2025-10-28T05:45:04.335000+00:00",
      "duration_hours": 1.0
    },
    "request_type": "raw",
    "num_queries": 1
  },
  "llm_info": {
    "model": "anthropic.claude-3-5-sonnet-20241022-v2:0",
    "service": "AWS Bedrock"
  }
}